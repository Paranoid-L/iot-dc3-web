(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-549b5aae"],{"178a":function(t,e,a){},"22c7":function(t,e,a){"use strict";a("178a")},"3a79":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"things-card"},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"things-card-content"},[a("div",{staticClass:"things-card__header",class:{"header-enable":t.data.enable,"header-disable":!t.data.enable}},[a("div",{staticClass:"things-card-header-icon"},[a("img",{attrs:{src:t.icon,alt:t.data.name}})]),a("div",{staticClass:"things-card-header-name nowrap-name",on:{click:function(e){return t.copyId(t.data.id)}}},[t._v(t._s(t.data.name))]),a("div",{staticClass:"things-card-header-status",attrs:{title:"状态"}},["ONLINE"===t.status(t.data.id)?a("el-tag",{attrs:{type:"success",effect:"plain"}},[t._v("在线")]):"MAINTAIN"===t.status(t.data.id)?a("el-tag",{attrs:{type:"warning",effect:"plain"}},[t._v("维护")]):"FAULT"===t.status(t.data.id)?a("el-tag",{attrs:{type:"danger",effect:"plain"}},[t._v("故障")]):"DISABLE"===t.status(t.data.id)?a("el-tag",{attrs:{type:"info",effect:"plain"}},[t._v("停用")]):a("el-tag",{attrs:{type:"info",effect:"plain"}},[t._v("离线")])],1)]),a("div",{staticClass:"things-card__body"},[a("div",{staticClass:"things-card-body-content"},[a("ul",[a("li",{staticClass:"nowrap-item"},[a("span",[a("i",{staticClass:"el-icon-s-promotion"}),t._v(" 所属驱动: ")]),t._v(t._s(t.driver(t.data.driverId)))]),a("li",{staticClass:"nowrap-item"},[a("span",[a("i",{staticClass:"el-icon-tickets"}),t._v(" 包含模板: ")]),t._v(t._s(t.data.profileIds?t.profile(t.data.profileIds):""))]),a("li",{staticClass:"nowrap-item"},[a("span",[a("i",{staticClass:"el-icon-coin"}),t._v(" 存储类型: ")]),t._v(t._s(t.data.multi?"结构数据":"单点数据"))]),a("li",{staticClass:"nowrap-item"},[a("span",[a("i",{staticClass:"el-icon-edit-outline"}),t._v(" 修改日期: ")]),t._v(t._s(t.timestamp(t.data.updateTime)))]),a("li",{staticClass:"nowrap-item"},[a("span",[a("i",{staticClass:"el-icon-sunset"}),t._v(" 创建日期: ")]),t._v(t._s(t.timestamp(t.data.createTime)))])])]),a("div",{staticClass:"things-card-body-content",attrs:{title:"设备描述信息"}},[a("p",{staticClass:"nowrap-description"},[t._v(t._s(t.data.description?t.data.description:"无描述信息"))])])]),t.embedded?t._e():a("div",{staticClass:"things-card__footer"},[a("div",{staticClass:"things-card-footer-operation"},[a("el-popconfirm",{attrs:{title:"是否确定停用该设备？",placement:"top",icon:"el-icon-remove-outline"}},[a("el-button",{staticClass:"operation-tooltip",attrs:{slot:"reference",type:"text",disabled:!t.data.enable},slot:"reference"},[t._v("停用")])],1),a("el-popconfirm",{attrs:{title:"是否确定启用该设备？",placement:"top",icon:"el-icon-remove-outline"}},[a("el-button",{staticClass:"operation-tooltip",attrs:{slot:"reference",type:"text",disabled:t.data.enable},slot:"reference"},[t._v("启用")])],1),a("el-popconfirm",{attrs:{title:"是否确定删除该设备？",placement:"top",icon:"el-icon-circle-close","icon-color":"red"},on:{confirm:function(e){return t.deleteThing(t.data.id)}}},[a("el-button",{staticClass:"operation-tooltip",attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("删除")])],1),a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.edit(t.data.id,t.data.driverId)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.detail(t.data.id,t.data.driverId)}}},[t._v("详情")])],1)])])])],1)},i=[],n=(a("fb6a"),a("a15b"),a("d81d"),a("0e0b")),o={name:"device-card",props:{embedded:{type:Boolean,default:function(){return!1}},driverTable:{type:Object,default:function(){return{}}},profileTable:{type:Object,default:function(){return{}}},statusTable:{type:Object,default:function(){return{}}},data:{type:Object,default:function(){return{name:"",driverId:"",profileIds:[],multi:!1,enable:!0,description:"",createTime:"",updateTime:""}}},icon:{type:String,default:"images/common/device.png"}},methods:{driver:function(t){return this.driverTable[t]},profile:function(t){var e=this;if(t)return t.length>10&&(t=t.slice(0,10)),t.map((function(t){return e.profileTable[t]})).join(", ")},status:function(t){return this.statusTable[t]},deleteThing:function(t){this.$emit("delete-thing",t,(function(){Object(n["d"])()}))},edit:function(t,e){this.$router.push({name:"deviceEdit",query:{id:t,driverId:e,active:"0"}})},detail:function(t,e){this.$router.push({name:"deviceDetail",query:{id:t,driverId:e,active:"detail"}})},copyId:function(t){Object(n["c"])(t,!0,"设备ID")},timestamp:function(t){return Object(n["a"])(new Date(t))}}},l=o,s=(a("566c"),a("2877")),c=Object(s["a"])(l,r,i,!1,null,null,null);e["a"]=c.exports},"4d03":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",[a("device-tool",{attrs:{page:t.page,driverDictionary:t.driverDictionary},on:{search:t.search,reset:t.reset,showAdd:t.showAdd,refresh:t.refresh,sort:t.sort,"size-change":t.sizeChange,"current-change":t.currentChange}})],1),a("blank-card",[a("el-row",t._l(t.listData,(function(e){return a("el-col",{key:e.id,attrs:{xs:24,sm:12,md:8,lg:6,xl:4}},[a("device-card",{attrs:{data:e,driverTable:t.driverTable,profileTable:t.profileTable,statusTable:t.statusTable},on:{"delete-thing":t.deleteThing}})],1)})),1)],1),a("device-add-form",{ref:"add-form",attrs:{driverDictionary:t.driverDictionary,profileDictionary:t.profileDictionary},on:{"add-thing":t.addThing}})],1)},i=[],n=a("5530"),o=a("c333"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tool-card"},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"tool-card-content"},[a("div",{staticClass:"tool-card-content-search"},[a("el-form",{ref:"formData",attrs:{inline:!0,model:t.formData,rules:t.formRule,size:"small"}},[a("div",{staticClass:"tool-card-content-search-form"},[a("el-form-item",{attrs:{label:"设备名称",prop:"name"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入设备名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)}},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"所属驱动",prop:"driverId"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择所属驱动",filterable:""},model:{value:t.formData.driverId,callback:function(e){t.$set(t.formData,"driverId",e)},expression:"formData.driverId"}},t._l(t.driverDictionary,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"存储类型",prop:"multi"}},[a("el-select",{staticClass:"search-form-medium",attrs:{clearable:"",placeholder:"请选择存储类型"},model:{value:t.formData.multi,callback:function(e){t.$set(t.formData,"multi",e)},expression:"formData.multi"}},[a("el-option",{attrs:{label:"单点数据",value:!1}}),a("el-option",{attrs:{label:"结构数据",value:!0}})],1)],1),a("el-form-item",{attrs:{label:"使能",prop:"enable"}},[a("el-select",{staticClass:"search-form-small",attrs:{clearable:"",placeholder:"请选择使能"},model:{value:t.formData.enable,callback:function(e){t.$set(t.formData,"enable",e)},expression:"formData.enable"}},[a("el-option",{attrs:{label:"启用",value:!0}}),a("el-option",{attrs:{label:"停用",value:!1}})],1)],1)],1),a("el-form-item",{staticClass:"tool-card-content-search-button"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1),a("div",{staticClass:"tool-card-content-operation"},[a("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-plus"},on:{click:t.showAdd}},[t._v("新增")]),a("div",{staticClass:"tool-card-content-operation-page"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, sizes","page-sizes":[12,24,36,48],"page-size":+t.page.size,"current-page":+t.page.current,total:+t.page.total},on:{"size-change":t.sizeChange,"current-change":t.currentChange}}),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"刷新",placement:"top"}},[a("el-button",{attrs:{size:"small",icon:"el-icon-refresh",circle:""},on:{click:t.refresh}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"排序",placement:"top"}},[a("el-button",{attrs:{size:"small",icon:"el-icon-sort",circle:""},on:{click:t.sort}})],1)],1)],1)])])],1)},s=[],c={name:"device-tool",props:{driverDictionary:{type:Array,default:function(){return[]}},page:{type:Object,default:function(){return{}}}},data:function(){return{formData:{},formRule:{}}},methods:{search:function(){var t=this;this.$refs["formData"].validate((function(e){e&&t.$emit("search",t.formData)}))},reset:function(){this.$refs["formData"].resetFields(),this.$emit("reset")},showAdd:function(){this.$emit("showAdd")},refresh:function(){this.$emit("refresh")},sort:function(){this.$emit("sort")},sizeChange:function(t){this.$emit("size-change",t)},currentChange:function(t){this.$emit("current-change",t)}}},d=c,u=(a("22c7"),a("2877")),f=Object(u["a"])(d,l,s,!1,null,null,null),p=f.exports,m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"things-dialog",attrs:{title:"新增设备",visible:t.formVisible,"show-close":!1,"append-to-body":!0,"model-append-to-body":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.formVisible=e}}},[a("el-form",{ref:"formData",attrs:{size:"small",model:t.formData,rules:t.formRule}},[a("el-form-item",{staticClass:"things-dialog-form-item",attrs:{label:"设备名称",prop:"name"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入设备名称"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("el-form-item",{staticClass:"things-dialog-form-item",attrs:{label:"所属驱动",prop:"driverId"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择所属驱动 | 网关",filterable:""},model:{value:t.formData.driverId,callback:function(e){t.$set(t.formData,"driverId",e)},expression:"formData.driverId"}},t._l(t.driverDictionary,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{staticClass:"things-dialog-form-item",attrs:{label:"包含模板",prop:"profileIds"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择包含模板",multiple:!0,filterable:""},model:{value:t.formData.profileIds,callback:function(e){t.$set(t.formData,"profileIds",e)},expression:"formData.profileIds"}},t._l(t.profileDictionary,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{staticClass:"things-dialog-form-item",attrs:{label:"存储类型",prop:"multi"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择存储类型"},model:{value:t.formData.multi,callback:function(e){t.$set(t.formData,"multi",e)},expression:"formData.multi"}},[a("el-option",{attrs:{label:"单点数据",value:!1}}),a("el-option",{attrs:{label:"结构数据",value:!0}})],1)],1),a("el-form-item",{staticClass:"things-dialog-form-item",attrs:{label:"描述",prop:"description"}},[a("el-input",{attrs:{clearable:"",type:"textarea",maxlength:"300","show-word-limit":"",placeholder:"请输入设备描述"},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:t.cancel}},[t._v("取消")]),a("el-button",{attrs:{type:"success",size:"small",plain:""},on:{click:t.reset}},[t._v("重置")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addThing}},[t._v("确定")])],1)],1)},h=[],v=a("0e0b"),b={name:"device-add-form",props:{driverDictionary:{type:Array,default:function(){return[]}},profileDictionary:{type:Array,default:function(){return[]}}},data:function(){return{formData:{multi:!1},formRule:{name:[{required:!0,message:"请输入设备名称",trigger:"blur"},{min:2,max:32,message:"请输入 2~32 位字长的设备名称",trigger:"blur"},{pattern:/^[A-Za-z0-9\u4e00-\u9fa5][A-Za-z0-9\u4e00-\u9fa5-_]*$/,message:"请输入正确格式的设备名称"}],driverId:[{required:!0,message:"请选择所属驱动 | 网关",trigger:"change"}],description:[{max:300,message:"最多输入300个字符",trigger:"blur"}]},formVisible:!1}},methods:{show:function(){this.formVisible=!0},cancel:function(){this.formVisible=!1},reset:function(){this.$refs["formData"].resetFields()},addThing:function(){var t=this;this.$refs["formData"].validate((function(e){e&&t.$emit("add-thing",t.formData,(function(){t.cancel(),t.reset(),Object(v["d"])()}))}))}}},g=b,y=(a("cd36"),Object(u["a"])(g,m,h,!1,null,null,null)),D=y.exports,_=a("3a79"),O=a("aa98"),C=a("e56e"),j={components:{blankCard:o["a"],deviceTool:p,deviceAddForm:D,deviceCard:_["a"]},data:function(){return{driverDictionary:[],profileDictionary:[],driverTable:{},profileTable:{},statusTable:{},listData:[],query:{},order:!1,page:{total:0,size:12,current:1}}},created:function(){this.driver(),this.profile(),this.list()},methods:{list:function(){var t=this;Object(O["f"])(Object(n["a"])({page:this.page},this.query)).then((function(e){var a=e.data;t.page.total=a.total,t.listData=a.records})).catch((function(){})),Object(O["g"])(Object(n["a"])({page:this.page},this.query)).then((function(e){t.statusTable=e.data})).catch((function(){}))},driver:function(){var t=this;Object(C["b"])().then((function(e){t.driverDictionary=e.data,t.driverTable=t.driverDictionary.reduce((function(t,e){return t[e.value]=e.label,t}),{})})).catch((function(){}))},profile:function(){var t=this;Object(C["d"])().then((function(e){t.profileDictionary=e.data,t.profileTable=t.profileDictionary.reduce((function(t,e){return t[e.value]=e.label,t}),{})})).catch((function(){}))},search:function(t){this.query=t,this.list()},reset:function(){this.query={},this.list()},showAdd:function(){this.$refs["add-form"].show()},addThing:function(t,e){var a=this;Object(O["a"])(t).then((function(){a.list(),e()})).catch((function(){}))},deleteThing:function(t,e){var a=this;Object(O["e"])(t).then((function(){a.list(),e()})).catch((function(){}))},refresh:function(){this.list()},sort:function(){this.order=!this.order,this.order?this.page.orders=[{column:"create_time",asc:!0}]:this.page.orders=[{column:"create_time",asc:!1}],this.list()},sizeChange:function(t){this.page.size=t,this.list()},currentChange:function(t){this.page.current=t,this.list()}}},k=j,w=Object(u["a"])(k,r,i,!1,null,null,null);e["default"]=w.exports},5530:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("b64b"),a("a4d3"),a("4de4"),a("e439"),a("159b"),a("dbb4");function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function n(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}},"566c":function(t,e,a){"use strict";a("b2ee")},"656b":function(t,e,a){"use strict";a("a508")},a508:function(t,e,a){},aa98:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"e",(function(){return n})),a.d(e,"j",(function(){return o})),a.d(e,"c",(function(){return l})),a.d(e,"b",(function(){return s})),a.d(e,"d",(function(){return c})),a.d(e,"f",(function(){return d})),a.d(e,"g",(function(){return u})),a.d(e,"h",(function(){return f})),a.d(e,"i",(function(){return p}));var r=a("9179"),i=function(t){return Object(r["a"])({url:"api/v3/manager/device/add",method:"post",data:t})},n=function(t){return Object(r["a"])({url:"api/v3/manager/device/delete/"+t,method:"post"})},o=function(t){return Object(r["a"])({url:"api/v3/manager/device/update",method:"post",data:t})},l=function(t){return Object(r["a"])({url:"api/v3/manager/device/id/"+t,method:"get"})},s=function(t){return Object(r["a"])({url:"api/v3/manager/device/driver_id/"+t,method:"get"})},c=function(t){return Object(r["a"])({url:"api/v3/manager/device/profile_id/"+t,method:"get"})},d=function(t){return Object(r["a"])({url:"api/v3/manager/device/list",method:"post",data:t})},u=function(t){return Object(r["a"])({url:"api/v3/manager/status/device",method:"post",data:t})},f=function(t){return Object(r["a"])({url:"api/v3/manager/status/device/driver_id/"+t,method:"get"})},p=function(t){return Object(r["a"])({url:"api/v3/manager/status/device/profile_id/"+t,method:"get"})}},b2ee:function(t,e,a){},c333:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"blank-card"},[a("el-card",{attrs:{shadow:"hover"}},[t._t("default")],2)],1)},i=[],n={name:"blank-card"},o=n,l=(a("656b"),a("2877")),s=Object(l["a"])(o,r,i,!1,null,null,null);e["a"]=s.exports},cd36:function(t,e,a){"use strict";a("f6e3")},d81d:function(t,e,a){"use strict";var r=a("23e7"),i=a("b727").map,n=a("1dde"),o=n("map");r({target:"Array",proto:!0,forced:!o},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},dbb4:function(t,e,a){var r=a("23e7"),i=a("83ab"),n=a("56ef"),o=a("fc6a"),l=a("06cf"),s=a("8418");r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(t){var e,a,r=o(t),i=l.f,c=n(r),d={},u=0;while(c.length>u)a=i(r,e=c[u++]),void 0!==a&&s(d,e,a);return d}})},e439:function(t,e,a){var r=a("23e7"),i=a("d039"),n=a("fc6a"),o=a("06cf").f,l=a("83ab"),s=i((function(){o(1)})),c=!l||s;r({target:"Object",stat:!0,forced:c,sham:!l},{getOwnPropertyDescriptor:function(t,e){return o(n(t),e)}})},e56e:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return l}));var r=a("9179"),i=function(){return Object(r["a"])({url:"api/v3/manager/dictionary/driver",method:"get"})},n=function(){return Object(r["a"])({url:"api/v3/manager/dictionary/profile",method:"get"})},o=function(){return Object(r["a"])({url:"api/v3/manager/dictionary/device",method:"get"})},l=function(t){return Object(r["a"])({url:"api/v3/manager/dictionary/point/"+t,method:"get"})}},f6e3:function(t,e,a){}}]);